# Five Features Deployment Checklist

**Version**: 1.0.0  
**Date**: November 19, 2025  
**Status**: Ready for Implementation

---

## Pre-Deployment Phase (Week 0)

### Environment Setup
- [ ] Verify Node.js 16+ installed: `node --version`
- [ ] Verify Firebase CLI installed: `firebase --version`
- [ ] Verify authenticated to Firebase: `firebase login --list`
- [ ] Set correct Firebase project: `firebase use --add`
- [ ] Verify Firestore emulator setup (optional for testing)

### API Provider Setup
- [ ] Sign up for OpenAI API (https://platform.openai.com)
- [ ] Generate API key with GPT-3.5/4 access
- [ ] Note API key budget/usage limits
- [ ] Create test API calls to verify access
- [ ] Document API rate limits (requests/min)

### Repository Setup
- [ ] Create feature branch: `git checkout -b feat/five-features`
- [ ] Review existing codebase structure
- [ ] Verify TypeScript types available
- [ ] Check existing service file patterns

---

## Phase 1: Firestore Rules & Schema (Days 1-2)

### Rules Deployment
- [ ] Review current `firestore.rules` file
- [ ] Add all new rule sections from FIVE_FEATURES_IMPLEMENTATION_GUIDE.md Part 2:
  - [ ] Student Dashboard & CBT rules
  - [ ] CBT Questions & Exams rules
  - [ ] Scheme of Work rules
  - [ ] Notifications rules
  - [ ] AI API Keys rules (coordinator only)
  - [ ] Helper functions (hasValidEnrollment, isEnrolledIn)
- [ ] Test rules locally (Firebase emulator): `firebase emulators:start`
- [ ] Deploy rules: `firebase deploy --only firestore:rules`
- [ ] Verify deployment in Firebase Console: https://console.firebase.google.com

### Test Rules Deployment
- [ ] Login as student user
- [ ] Attempt to read own course â†’ âœ“ Should succeed
- [ ] Attempt to read other student's course â†’ âœ— Should fail
- [ ] Login as teacher
- [ ] Attempt to create question â†’ âœ“ Should succeed
- [ ] Login as coordinator
- [ ] Attempt to save API key â†’ âœ“ Should succeed

### Firestore Collections Auto-Creation
- [ ] Set up initial test data in Firestore (or auto-creates on first write):
  - [ ] courses collection
  - [ ] student_enrollments collection
  - [ ] cbt_questions collection
  - [ ] cbt_exams collection
  - [ ] exam_attempts collection
  - [ ] scheme_of_work (as subcollection)
  - [ ] notifications collection
  - [ ] ai_api_keys collection
  - [ ] system_settings collection
- [ ] Verify collections appear in Firebase Console
- [ ] Create `system_settings/general` document with defaults

### Indexes Creation
- [ ] Create composite indexes (auto-generated by Firestore when querying):
  - [ ] courses: `status` (Asc), `createdAt` (Desc)
  - [ ] courses: `teacherId` (Asc), `status` (Asc)
  - [ ] student_enrollments: `studentId` (Asc), `paymentStatus` (Asc)
  - [ ] student_enrollments: `courseId` (Asc), `paymentStatus` (Asc)
  - [ ] cbt_questions: `courseId` (Asc), `questionNumber` (Asc)
  - [ ] cbt_questions: `courseId` (Asc), `topic` (Asc)
  - [ ] cbt_exams: `courseId` (Asc), `scheduledAt` (Asc)
  - [ ] exam_attempts: `studentId` (Asc), `completedAt` (Desc)
  - [ ] notifications: `userId` (Asc), `createdAt` (Desc)
- [ ] Monitor Firebase Console for index building status

---

## Phase 2: Service Files & Utilities (Days 3-5)

### Create Core Services
- [ ] Create `src/lib/aiQuestionService.ts`:
  - [ ] `generateQuestionsWithAI()` function
  - [ ] `verifyAPIKey()` function
  - [ ] `autoMarkExam()` function (for objective questions)
  - [ ] Error handling for API failures
  - [ ] Request/response types
  - [ ] Add JSDoc comments
  - [ ] Unit tests

- [ ] Create `src/lib/notificationService.ts`:
  - [ ] `sendExamNotification()` function
  - [ ] `getUnreadNotifications()` function
  - [ ] `markNotificationAsRead()` function
  - [ ] `hasUnreadExamNotifications()` function
  - [ ] Batch operations for efficiency
  - [ ] Add JSDoc comments
  - [ ] Unit tests

- [ ] Create `src/lib/enrollmentService.ts`:
  - [ ] `getPaidCourses()` function
  - [ ] `checkEnrollment()` function
  - [ ] `getEnrolledStudents()` function
  - [ ] Cache layer (optional)
  - [ ] Add JSDoc comments

- [ ] Create `src/lib/cbtService.ts`:
  - [ ] `getQuestionsForExam()` function
  - [ ] `submitExamAttempt()` function
  - [ ] `autoRenumberQuestions()` function
  - [ ] `getExamById()` function
  - [ ] Add JSDoc comments
  - [ ] Unit tests

### Test Services
- [ ] Mock Firestore data
- [ ] Unit tests for each service
- [ ] Integration tests with Firestore emulator
- [ ] Test error handling (API failures, network issues)
- [ ] Test edge cases (1-hour validation, auto-renumbering)

### Code Review
- [ ] Review service code for security
- [ ] Check for SQL injection / data injection
- [ ] Verify no sensitive data in logs
- [ ] Check error messages don't leak info
- [ ] Review TypeScript types for safety

---

## Phase 3: Component Development (Days 6-12)

### Coordinator Dashboard - AI API Key Tab
- [ ] Create `src/components/coordinator/AIAPIKeyTab.tsx`:
  - [ ] Input field with password mask
  - [ ] Provider dropdown (OpenAI, Cohere, HuggingFace)
  - [ ] Verify button
  - [ ] Status indicator (Verified âœ“ / Invalid âœ—)
  - [ ] Last verified timestamp display
  - [ ] Activate/Deactivate toggle
  - [ ] Error message display
  - [ ] Loading states
- [ ] Create supporting components:
  - [ ] `APIKeyInputForm.tsx`
  - [ ] `APIKeyStatusIndicator.tsx`
  - [ ] `APIKeyVerificationResult.tsx`
- [ ] Test coordinator can save API key
- [ ] Test verification works
- [ ] Test only coordinator can access

### Teacher Dashboard - Scheme of Work Tab
- [ ] Create `src/components/teacher/SchemeOfWorkTab.tsx`:
  - [ ] Lesson form with: title, topic, description, timeline, resources
  - [ ] Lesson preview cards
  - [ ] Edit button opens modal
  - [ ] Delete button with confirmation
  - [ ] Timeline visualization
  - [ ] Topic linking indicator
- [ ] Create supporting components:
  - [ ] `LessonInputForm.tsx`
  - [ ] `LessonPreviewCard.tsx`
  - [ ] `LessonEditModal.tsx`
  - [ ] `LessonDeleteConfirm.tsx`
- [ ] Test CRUD operations (Create, Read, Update, Delete)
- [ ] Test teacher can only edit own course lessons
- [ ] Test students see lessons for enrolled courses

### Teacher Dashboard - CBT Management Tab
- [ ] Create `src/components/teacher/CBTManagementTab.tsx`:
  - [ ] Question list table
  - [ ] Preview modal
  - [ ] Edit modal
  - [ ] Delete with confirmation
  - [ ] Auto-renumbering after delete
  - [ ] Search/filter by topic
  - [ ] AI question generator modal
- [ ] Create supporting components:
  - [ ] `QuestionPreviewModal.tsx`
  - [ ] `QuestionEditModal.tsx`
  - [ ] `AIQuestionGeneratorModal.tsx`
  - [ ] `QuestionListTable.tsx`
- [ ] Test AI generation with real API
- [ ] Test auto-renumbering logic
- [ ] Test teacher can only manage own course questions
- [ ] Test questions don't show correct answers to students

### Teacher Dashboard - Exam Scheduling
- [ ] Create `src/components/teacher/ExamSchedulingModal.tsx`:
  - [ ] Date/time picker
  - [ ] 1-hour minimum validation
  - [ ] Exam duration input
  - [ ] Question selection
  - [ ] Passing score input
  - [ ] Confirmation dialog
  - [ ] Red dot indicator for new exams
- [ ] Create supporting components:
  - [ ] `DateTimePickerComponent.tsx`
  - [ ] `ScheduledExamsTable.tsx`
  - [ ] Validation logic
- [ ] Test 1-hour minimum enforcement
- [ ] Test notification sending
- [ ] Test red dot appears for new exams
- [ ] Test exam status updates (scheduled â†’ ongoing â†’ completed)

### Student Dashboard
- [ ] Create `src/pages/StudentDashboard.tsx`:
  - [ ] Paid Courses tab
  - [ ] CBT tab
  - [ ] Notifications bell
  - [ ] Tab navigation
- [ ] Create supporting components:
  - [ ] `PaidCoursesTab.tsx` - Display enrolled courses
  - [ ] `CBTTab.tsx` - Available exams for enrolled courses
  - [ ] `ExamTakingModal.tsx` - Exam taking interface with timer
  - [ ] `SchemeOfWorkModal.tsx` - View course curriculum
  - [ ] `ExamResultsModal.tsx` - Display exam results
  - [ ] `NotificationBell.tsx` - Red dot for unread notifications
- [ ] Test student sees only paid courses
- [ ] Test CBT questions from only purchased courses
- [ ] Test exam timer works
- [ ] Test auto-marking works
- [ ] Test results display correctly
- [ ] Test red dot appears for new exams

### Component Testing
- [ ] Visual regression testing (Chromatic recommended)
- [ ] Interactive testing (Cypress)
- [ ] Accessibility testing (axe-core)
- [ ] Mobile responsiveness testing
- [ ] Dark mode testing
- [ ] Error state testing
- [ ] Loading state testing

---

## Phase 4: Integration & Testing (Days 13-15)

### Integration Tests
- [ ] Test end-to-end flow for each user type:
  - [ ] **Coordinator**: Login â†’ Set API Key â†’ Verify â†’ Activate
  - [ ] **Teacher**: Login â†’ Create Scheme of Work â†’ Generate Questions â†’ Schedule Exam â†’ Send Notifications
  - [ ] **Student**: Login â†’ View Paid Courses â†’ Take Exam â†’ View Results â†’ Check Notifications
- [ ] Test data flows correctly between components
- [ ] Test real-time updates (questions, exams, notifications)
- [ ] Test with multiple concurrent users

### Security Testing
- [ ] Test student cannot access other students' attempts
- [ ] Test teacher cannot access other courses
- [ ] Test teacher cannot see correct answers
- [ ] Test API key is encrypted in Firestore
- [ ] Test API key not logged
- [ ] Test rules prevent unauthorized access
- [ ] Test coordinator has exclusive API key access
- [ ] Penetration testing of rules (attempt rule bypass)

### Performance Testing
- [ ] Load test with 100+ concurrent students taking exams
- [ ] Test question generation API response time
- [ ] Test notification sending performance
- [ ] Monitor Firestore read/write costs
- [ ] Check bundle size impact
- [ ] Test with slow network conditions (3G)
- [ ] Profile React components for re-renders
- [ ] Optimize if needed (lazy loading, caching, etc)

### UAT (User Acceptance Testing)
- [ ] Test with 5+ real coordinator users
- [ ] Test with 10+ real teacher users
- [ ] Test with 20+ real student users
- [ ] Gather feedback on UX
- [ ] Test on multiple devices (desktop, tablet, mobile)
- [ ] Test on different browsers
- [ ] Document feedback and prioritize fixes

---

## Phase 5: Documentation & Deployment (Days 16-18)

### Documentation
- [ ] **User Guides**:
  - [ ] Student User Guide (how to access courses, take exams, view results)
  - [ ] Teacher User Guide (manage questions, schedule exams, view scheme of work)
  - [ ] Coordinator User Guide (manage API key)
- [ ] **Technical Documentation**:
  - [ ] API integration guide (with cURL examples)
  - [ ] Firestore rules explanation
  - [ ] Service file documentation
  - [ ] Data model reference
  - [ ] Troubleshooting guide
  - [ ] Deployment runbook
- [ ] **Deployment Guide**:
  - [ ] Step-by-step deployment instructions
  - [ ] Rollback procedures
  - [ ] Monitoring setup
  - [ ] Error handling procedures
  - [ ] Support contact information

### Code Quality
- [ ] Run linter: `eslint src --fix`
- [ ] Format code: `prettier --write src`
- [ ] TypeScript check: `tsc --noEmit`
- [ ] Build test: `npm run build`
- [ ] No console.errors in production build
- [ ] No hardcoded secrets/keys

### Pre-Production Checklist
- [ ] All tests passing (unit, integration, e2e)
- [ ] All code reviewed and approved
- [ ] Security audit completed
- [ ] Performance benchmarks met
- [ ] Documentation complete
- [ ] Rollback plan documented
- [ ] Team trained on new features
- [ ] Support team ready

### Production Deployment
- [ ] Create release branch: `git checkout -b release/v2.0.0`
- [ ] Update version number in package.json
- [ ] Update CHANGELOG.md
- [ ] Merge to main branch
- [ ] Tag release: `git tag v2.0.0`
- [ ] Build production bundle: `npm run build`
- [ ] Deploy to production:
  - [ ] Deploy Firestore rules: `firebase deploy --only firestore:rules`
  - [ ] Deploy application: `firebase deploy --only hosting`
  - [ ] Or: Deploy to Vercel, AWS, etc.
- [ ] Verify production deployment
- [ ] Monitor for errors (Firebase Console, Sentry, etc)
- [ ] Celebrate! ðŸŽ‰

---

## Post-Deployment Phase (Day 19+)

### Monitoring (First 7 Days)
- [ ] Monitor Firestore read/write usage
- [ ] Monitor API costs (OpenAI API)
- [ ] Check error rates
- [ ] Review Firebase Console for issues
- [ ] Monitor user feedback channels
- [ ] Response plan for critical bugs
- [ ] Document any issues found

### Maintenance Schedule
- [ ] Daily: Check error logs, monitor costs
- [ ] Weekly: Review usage metrics, user feedback
- [ ] Monthly: Security audit of API key usage
- [ ] Quarterly: Performance review, scaling analysis
- [ ] Annually: Security penetration testing

### Future Enhancements
- [ ] [ ] Cloud Functions for server-side validation (improve security)
- [ ] [ ] Email notifications (in addition to in-app)
- [ ] [ ] SMS notifications for exam reminders
- [ ] [ ] Certificate generation and download
- [ ] [ ] Exam analytics dashboard for teachers
- [ ] [ ] Student progress tracking
- [ ] [ ] Leaderboards and gamification
- [ ] [ ] Payment integration refinement
- [ ] [ ] Export exam results to CSV
- [ ] [ ] API for third-party integrations

---

## Rollback Plan

If critical issues arise post-deployment:

### Immediate Actions (First 30 minutes)
1. Disable new features: Set `maintenanceMode: true` in system_settings
2. Revert Firestore rules to previous version
3. Revert application to previous version
4. Notify support team and users
5. Create incident report

### Rollback Steps (if needed)
```bash
# Revert rules
firebase deploy --only firestore:rules  # (after reverting code)

# Revert application
firebase deploy --only hosting  # (deploy previous build)
# or
git revert HEAD
npm run build
firebase deploy
```

### Communication
- [ ] Notify users via email
- [ ] Update status page
- [ ] Document issue in incident log
- [ ] Schedule post-mortem

---

## Sign-Off

- [ ] **Project Manager**: __________ Date: __________
- [ ] **Tech Lead**: __________ Date: __________
- [ ] **QA Lead**: __________ Date: __________
- [ ] **Security Lead**: __________ Date: __________
- [ ] **Coordinator** (Stakeholder): __________ Date: __________

---

## Contact & Support

**For Deployment Issues**:
- Email: dev-team@bytesoft.com
- Slack: #deployment-support
- Emergency: +234-xxx-xxx-xxxx

**Firebase Support**: https://firebase.google.com/support
**OpenAI API Support**: https://help.openai.com

---

**Document Status**: âœ… Ready for Deployment  
**Last Updated**: November 19, 2025  
**Version**: 1.0.0
